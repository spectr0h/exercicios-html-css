local config = {

    {name="Traders", position=Position(994, 1030, 6)},
    {name="Ab'Dendriel", position=Position(32732, 31634, 7)},
    {name="Carlin", position=Position(32360, 31782, 7)},
    {name="Kazordoon", position=Position(32649, 31925, 11)},
    {name="Thais", position=Position(32369, 32241, 7)},
    {name="Venore", position=Position(32957, 32076, 7)},
    {name="Cyclops Camp", position=Position(32413, 32373, 7)},
    {name="Dwarfs", position=Position(32546, 31908, 7)},
    {name="Stone Golems", position=Position(32076, 31192, 8)},
    {name="Mintwalin", position=Position(32414, 32122, 15)},
    {name="Cyclops Mistrock", position=Position(32629, 31439, 7)},
    {name="Dragon Lair Ank", position=Position(33084, 32679, 6)},
    {name="Carniphila", position=Position(32885, 32591, 7)},
    {name="Dragon Lair Darashia", position=Position(33254, 32278, 10)},
    {name="Dragon Lair Khaz'eel", position=Position(32982, 32647, 7)},
    {name="Coryms", position=Position(32602, 32806, 8)},
    {name="Earth Elemental", position=Position(33154, 31723, 8)},
    {name="Mutated Humans", position=Position(32692, 31183, 7)},
    {name="Giant Spiders", position=Position(32851, 32868, 7)},	
    {name="Orc Fortress", position=Position(32809, 31788, 7)},
    {name="Forbidden Temple", position=Position(33315, 32675, 8)},
    {name="Deepling Temple", position=Position(33446, 31273, 14)},
    {name="Quaras", position=Position(32951, 31181, 9)},
    {name="Hero Fortress", position=Position(33224, 31649, 7)},
    {name="Deeper Drefia", position=Position(32998, 32407, 10)},
    {name="Banshee Temple", position=Position(32229, 31883, 13)},
    {name="Vampire's Crypt", position=Position(33065, 31596, 10)},
    {name="Wigglers", position=Position(32988, 31884, 11)},
    {name="Scarabs Lair", position=Position(33356, 32614, 11)},
    {name="Hydra Talahu", position=Position(31921, 32659, 7)},
    {name="Krailos Ruins", position=Position(33580, 31586, 8)},
    {name="Demona", position=Position(32479, 31689, 15)},
    {name="Frost Dragons", position=Position(32225, 31382, 7)},
    {name="Yelothax", position=Position(33143, 31533, 3)},
    {name="Drefia Wyrms", position=Position(33068, 32396, 12)},
    {name="Vandura Wyrms", position=Position(32388, 32844, 8)},
    {name="Grim Reaper Drefia", position=Position(33030, 32450, 11)},
    {name="Dragon Lair Fenrock", position=Position(32600, 31396, 14)},
    {name="Lower Spike", position=Position(32242, 32606, 13)},
    {name="Lizard Chosen 1", position=Position(33285, 31204, 9)},
    {name="Behemoth", position=Position(33015, 32564, 8)},
    {name="Formogar Mines", position=Position(32156, 31125, 11)},
    {name="Lizard Chosen 2", position=Position(33181, 31199, 8)},
    {name="Glooth Factory", position=Position(33497, 31961, 12)},
    {name="Grimvale", position=Position(33342, 31692, 7)},
    {name="Ghastly Dragon", position=Position(33176, 31016, 7)},
    {name="Demons Edron", position=Position(33143, 31697, 13)},
    {name="Feyrist Nightmare", position=Position(33547, 32267, 8)},
    {name="Hydra Oramond", position=Position(33505, 31886, 8)},
    {name="Medusa Cave", position=Position(31928, 32632, 10)},
    {name="Razachai", position=Position(33083, 31218, 7)},
    {name="Fury Hell", position=Position(33295, 31799, 14)},
    {name="Upper Roshamuul", position=Position(33643, 32370, 5)},
    {name="Nightmare Isles", position=Position(33499, 32616, 8)},
    {name="Minotaur Cult", position=Position(31947, 32501, 8)},
    {name="Asura Palace", position=Position(32949, 32690, 7)},
    {name="Deeper Banuta", position=Position(32892, 32632, 11)},
    {name="Carnivora's Rock", position=Position(32759, 32628, 8)},
    {name="Lions Bounac", position=Position(32400, 32459, 6)},	
    {name="Hyaena Lairs", position=Position(33222, 32352, 10)},
    {name="Issavi Sewers", position=Position(33900, 31525, 7)},
    {name="Lower Roshamuul", position=Position(33539, 32480, 6)},
    {name="Medusa Tower", position=Position(32864, 32831, 8)},
    {name="Roshamuul Prison", position=Position(33591, 32433, 8)},
    {name="Cobra Bastion", position=Position(33386, 32628, 7)},
    {name="Hell Hub", position=Position(33322, 32324, 12)},
    {name="Asura Mirror", position=Position(32812, 32755, 9)},	
    {name="Kilmaresh Catacombs", position=Position(33871, 31456, 6)},	
    {name="Deep Desert", position=Position(32956, 32320, 8)},	
    {name="Winter Court", position=Position(32354, 31248, 3)},	
    {name="Summer Court", position=Position(33584, 32208, 7)},	
    {name="Falcon Bastion", position=Position(33365, 31329, 4)},
    {name="Secret Library", position=Position(32515, 32537, 12)},	
    {name="Claustrophobic Inferno", position=Position(34011, 31012, 9)},	
    {name="Ebb and Flow", position=Position(33894, 31020, 8)},		
    {name="Furious Crater", position=Position(33862, 31833, 3)},
    {name="Mirrored Nightmare", position=Position(33888, 31185, 10)},
    {name="Rotten Wasteland", position=Position(33930, 31092, 13)},
	
	
}

local function checkCondition(player)
	storage = Storage.PlayerCubeTeleportTime
	tempo = 5

	if player:getGroup():getAccess() or player:getAccountType() == ACCOUNT_TYPE_GOD then
		return true
	end
	
	if (player:getStorageValue(storage) >= os.time()) then
		player:sendTextMessage(MESSAGE_EVENT_ADVANCE, "You need to wait 5 seconds to can use teleport system again!")
		player:getPosition():sendMagicEffect(CONST_ME_POFF)
		return false
	end
	
	if player:getAccountType() < ACCOUNT_TYPE_GOD then	
		player:setStorageValue(storage, os.time() + tempo)	
	end

    if player:getCondition(CONDITION_INFIGHT, CONDITIONID_DEFAULT) then
        player:sendTextMessage(MESSAGE_EVENT_ADVANCE, "Only work without fight.")
		player:getPosition():sendMagicEffect(CONST_ME_POFF)
        return false
		end
	return true
end
	

local teleportCube = Action()
function teleportCube.onUse(player, item, fromPosition, target, toPosition, isHotkey)
	if not (checkCondition(player)) then
		return false
	end
	local window = ModalWindow {
		title = "Teleport Cube",
		message = "Locations"
	}
	for i, info in pairs(config) do
		window:addChoice(string.format("%s", info.name), function (player, button, choice)
			if button.name ~= "Select" then
				return true
			end
			player:sendTextMessage(MESSAGE_EVENT_ADVANCE, "You were teleported to " .. info.name)
			player:teleportTo(info.position)
			player:getPosition():sendMagicEffect(CONST_ME_TELEPORT)
			item:transform(item:getId(), item:getCharges() -1)
			return true
		end)
	end
	window:addButton("Select")
	window:addButton("Close")
	window:setDefaultEnterButton(0)
	window:setDefaultEscapeButton(1)
	window:sendToPlayer(player)
	return true
end
teleportCube:id(31633)
teleportCube:register()
